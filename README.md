# ‚≠ê Lethargy-TS

`lethargy-ts` is a modern rewrite of `lethargy` ‚Äì a popular JavaScript library to help distinguish between scroll events initiated by the user, and those by inertial scrolling.

[![npm (scoped)](https://img.shields.io/npm/v/lethargy-ts?style=flat-square)](https://www.npmjs.com/package/lethargy-ts)
[![Bundle Size](https://img.shields.io/bundlephobia/min/lethargy-ts?style=flat-square)](https://bundlephobia.com/result?p=lethargy-ts)
![type definition](https://img.shields.io/npm/types/lethargy-ts)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://github.com/snelsi/lethargy-ts/blob/master/LICENSE)

üå≥ Tiny and Easy to use

ü¶Ñ Written in TypeScript

üéè Highly Customizable

üèñ No external dependencies

## Install

```ssh
yarn add lethargy-ts
```

or

```ssh
npm install --save lethargy-ts
```

## Usage

Import and create an instance of `Lethargy`. It will remember previously checked `wheelEvents` to help to determine if they are inertial or not:

```tsx
import { Lethargy } from "lethargy-ts";

const lethargy = new Lethargy();
```

You can customize parameters to better match your application's needs:

```tsx
const lethargy = new Lethargy({
  sensitivity: 20,
  delay: 100,
  inertiaDecay: 10,
});
```

> üòâ If you found optimizations for the defaults, please share them in this [ticket](https://github.com/snelsi/lethargy-ts/issues/1)!

Bind the wheel event and pass the event to `Lethargy`:

```tsx
const checkWheelEvent = (e: WheelEvent) => {
  const isIntentional = lethargy.check(e);

  if (isIntentional) {
    // Do something with the scroll event
  }
};

window.addEventListener("wheel", checkWheelEvent, { passive: true });
```

`lethargy.check(e)` will return `true` if it's a normal wheel event initiated by the user, and `false` if it's initiated by inertial scrolling.

## Options

All parameters are optional:

- `sensitivity` - Specifies the minimum value for `wheelDelta` for it to register as a valid scroll event. Because the tail of the curve has low `wheelDelta` values, this will stop them from registering as valid scroll events.

- `delay` - Threshold for the amount of time between mouse wheel events for them to be deemed separate.

- `inertiaDecay` - Inertia event may be no more than this percents smaller that previous event.

## What problem does it solve?

Scroll plugins such as [smartscroll](https://github.com/d4nyll/smartscroll), [jquery-mousewheel](https://github.com/jquery/jquery-mousewheel), or [fullPage.js](http://alvarotrigo.com/fullPage/) work by detecting scroll events and then doing something with them, such as scroll to the next frame. However, inertial scrolling continues to emit scroll events even after the user stopped, and this can often lead to problems, such as scrolling two to three frames when the user only scrolled once.

Sadly, right now there is no easy native way to tell if the wheel event was generated by the user or by inertia.
You can change this by leaving an upvote and a comment in the [w3c proposal ticket](https://github.com/w3c/uievents/issues/58). üëà

## How does it work?

There are some obvious cases when an event was generated by the user:

- Enough time passed between two events,

- Event's delta is bigger than the previous event's delta,

- Event's [vector](<https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)>) differ from previous event,

- Event's delta is above 100 and it doesn't decrease,

- Event doesn't decrease and immediately follows known human event,

- The speed of the delta's change suddenly jumped.

If any of those checks are true, the event is considered intentional. Otherwise, it's considered inertia.

## Limitations

Not all trackpads work the same. `Lethargy` makes its best efforts to cover as many use cases as possible, but full coverage is not guaranteed.

`Lethargy` focus on preventing false positives (saying it's a normal scroll event when it wasn't), but tolerates false negatives (saying it's not a normal scroll event when it is).

## TypeScript

The module is written in TypeScript and type definitions are included.

## Contributing

Contributions, issues, and feature requests are welcome!

## Show your support

Give a ‚≠êÔ∏è if you like this project!

## LICENSE

[MIT](./LICENSE)
